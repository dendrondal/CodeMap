<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Hive Plot</title>
	<style type="text/css">
	.link{
		fill: none;
		stroke-width: 1.5px;
	}
	.axis, .node{
		stroke: #000;
		stroke-width: 1.5px;
	}
	.tooltip{
		position: absolute;
		width: 50px;
		height: 30px;
		padding: 2px;
		font: 12px sans-serif;
		background: lightgreen;
		border: 0px;
		pointer-events: none;
	}
	/*.link:hover{
		stroke: red;
		stroke-opacity:.9;
	}*/
	</style>
</head>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="../static/hive.js"></script>
<script type="text/javascript">
var width = 960;
var height = 500;
var outerRadius = 240;
var innerRadius = 40;
var angle = d3.scale.ordinal()
		.domain(d3.range(4))
		.rangePoints([0,2 * Math.PI]);
var radius = d3.scale.linear()
		.range([innerRadius, outerRadius]);
var color = d3.scale.category10()
		.domain(d3.range(20));
var nodes = {{ nodes|tojson }};
var links = {{ links|tojson }};
var svg = d3.select("body").append("svg")
		.attr("width", width)
		.attr("height", height)
	.append("g")
		.attr("transform", "translate(" + width/2 + "," + height/2 + ")");
var tooltip = d3.select("body").append("div")
					.attr("class", "tooltip")
					.style("opacity", 0);
svg.selectAll(".axis")
		.data(d3.range(3))
	.enter().append("line")
		.attr("class", "axis")
		.attr("transform", function(d){ return "rotate(" + degrees(angle(d)) + ")";})
		.attr("x1", radius.range()[0])
		.attr("x2", radius.range()[1]);
svg.selectAll(".link")
    .data(links)
  .enter().append("path")
    .attr("class", "link")
    .attr("d", d3.hive.link()
    .angle(function(d) { return angle(d.x); })
    .radius(function(d) { return radius(d.y); }))
    .style("stroke", function(d) { return color(d.source.x); });
svg.selectAll(".node")
    .data(nodes)
  .enter().append("circle")
    .attr("class", "node")
    .attr("transform", function(d) { return "rotate(" + degrees(angle(d.x)) + ")"; })
    .attr("cx", function(d) { return radius(d.y); })
    .attr("r", 5)
    .style("fill", function(d) { return color(d.x); })
    .on("mouseover", function(d){
    	tooltip.transition()
    		.duration(200)
    		.style("opacity", .9);
    	tooltip.html("Node - " + d.package + "<br/>" + "Type - " + d.x)
    		.style("left", (d3.event.pageX + 5) + "px")
    		.style("top", (d3.event.pageY - 28) + "px");
    })
    .on("mouseout", function(d){
    	tooltip.transition()
    		.duration(500)
    		.style("opacity", 0);
    });
function degrees(radians) {
  return radians / Math.PI * 180 - 90;
}
</script>

</body>
</html>

